<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="Hkr32">
  
  <link rel="shortcut icon" href="../xenforo-favicon.png">
  
  <title>Среда разработки macOS - Документация XenForo 2</title>
	<link rel="stylesheet" href="../css/theme.css" type="text/css" />
	<link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
	<!-- <link rel="stylesheet" href="../css/highlight.css"> -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
		<link href="https://fonts.googleapis.com/css?family=Nunito+Sans&display=swap?d=2021-10-04%2012%3A35%3A56.876482%2B00%3A00" rel="stylesheet">
		<link href="../extra.css?d=2021-10-04%2012%3A35%3A56.876482%2B00%3A00" rel="stylesheet">
  
  <script>
    // Current page data
    var mkdocs_page_name = "\u0421\u0440\u0435\u0434\u0430 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0438 macOS";
    var mkdocs_page_input_path = "macos-dev.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Документация XenForo 2</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <p class="caption"><span class="caption-text">Обзор</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">Начало работы</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Администраторы сайта (или обычные)</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../template-syntax/">Синтаксис шаблонов</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../rest-api/">REST API</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Разработчики</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../add-on-structure/">Структура дополнения</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../development-tools/">Инструменты разработки</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../general-concepts/">Общие концепции</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../routing-basics/">Основы маршрутизации</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../controller-basics/">Основы контроллера</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../entities-finders-repositories/">Сущности, файндеры и репозитории</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../criteria/">Критерии</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../managing-the-schema/">Управление схемой</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../lets-build-an-add-on/">Создание дополнения</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Дизайнеры</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../designing-styles/">Разработка стилей</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../template-syntax/">Синтаксис шаблонов</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Приложения</span></p>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Среда разработки macOS</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#homebrew">Homebrew</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#xcode">Инструменты командной строки Xcode</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#homebrew_1">Установка Homebrew</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#homebrew_2">Установка пакетов Homebrew</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#php-apache-mariadb-elasticsearch-mailhog-imagemagick">PHP, Apache, MariaDB, ElasticSearch, Mailhog, ImageMagick</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#php-xdebug-imagemagick">Несколько версий PHP с Xdebug и ImageMagick</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_1">Настройка</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#mariadb">MariaDB</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#apache">Apache</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#php">PHP</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#xdebug-mailhog">Xdebug и Mailhog</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#fast-cgi-php-fpm">Fast CGI (php-fpm)</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#-">Авто-старт</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#php_1">Выбор версии PHP</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#htaccess-php-56">.htaccess для PHP 5.6</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#htaccess-php-74">.htaccess для PHP 7.4</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#htaccess-php-80">.htaccess для PHP 8.0</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#ide">IDE, отладка и менеджер БД</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_2">Ссылки на ресурсы</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_3">Обобщение</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#_4">Сводка команд терминала</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#_5">Сводка конфигурации</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#_6">Сделайте следующие правки</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#_7">Добавьте следующие файлы</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#htaccess-php">Файлы .htaccess, ориентированные на версии PHP</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#cjk">Примечание для пользователей CJK</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#imagick">Создавайте Imagick вручную</a>
    </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../linux-dev/">Среда разработки Linux</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../windows-dev/">Среда разработки Windows</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../vscode/">Visual Studio Code и Xdebug</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../scotchbox/">Scotch Box</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Документация XenForo 2</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Приложения &raquo;</li>
        
      
    
    <li>Среда разработки macOS</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/xenforo-ru/docs/edit/main-ru/docs/macos-dev.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr/>
</div>

          <div role="main">
            <div class="section">
              
	<h1 id="macos-php">Среда разработки на macOS с параллельными версиями PHP<a class="headerlink" href="#macos-php" title="Permanent link"></a></h1>
<p>Чтобы получить максимальную отдачу от фреймворка XenForo, вам понадобится локальный веб-сервер, способный запускать XenForo, а также способный отладчик и редактор кода, который понимает код и может помочь вам обойти его.</p>
<p>К счастью, эти требования теперь легко выполнить, и они ничего вам не будут стоить.</p>
<p>Этот документ и сопровождающее его видео помогут вам начать работу на Macintosh под управлением macOS 11 <em>Big Sur</em> или более поздней версии. Если вы хотите пропустить пояснения, вы можете пропустить документ и просто прочитать <a href="#summary">summary</a>.</p>
<div class="video-wrapper"><iframe width="560" height="315" src="https://www.youtube.com/embed/kiFqrd_dHz8" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div>
<hr />
<p>В качестве бонуса этот подход позволит вам запускать <strong>несколько версий PHP <em>одновременно</em></strong>, поэтому вы можете запускать экземпляры XenForo 1.5 на PHP 5.6, XenForo 2.1 на PHP 7.4 и XenForo 2.2 на PHP 8.0, если вы хотели <strong>без</strong> необходимости вручную переключать версию PHP, когда вы хотите получить доступ к определенной версии. Подробнее об этом позже.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Вы должны войти в macOS с учетной записью пользователя с правами администратора, чтобы выполнить действия, описанные в этом документе.</p>
</div>
<h2 id="homebrew">Homebrew<a class="headerlink" href="#homebrew" title="Permanent link"></a></h2>
<p><a href="https://brew.sh">Homebrew</a> - это менеджер пакетов для macOS, который обеспечивает относительно простой способ установки всех компонентов, необходимых для запуска локального веб-сервера и сервера базы данных. Он также может намного больше, но это выходит за рамки этого документа.</p>
<p>Одна замечательная вещь в Homebrew заключается в том, что он устанавливает свои пакеты в единое дерево каталогов, поэтому он хорошо изолирован от остальной части вашего Mac, что делает обслуживание и удаление гораздо менее болезненными, чем другие методы.</p>
<p>Хотя установка выполняется из командной строки, не позволяйте этому оттолкнуть вас, потому что результаты того стоят.</p>
<p>В качестве дополнительного бонуса буквально сейчас, когда я пишу это, Homebrew <a href="https://brew.sh/2021/02/05/homebrew-3.0.0/">анонсировала версию 3.0</a> с поддержкой <a href="https://support.apple.com/en-gb/HT211814">Apple Silicon</a>.</p>
<h3 id="xcode">Инструменты командной строки Xcode<a class="headerlink" href="#xcode" title="Permanent link"></a></h3>
<p>Чтобы установить Homebrew, нам нужно получить некоторые инструменты разработчика от Apple.</p>
<p><a href="https://developer.apple.com/xcode/features/">Xcode</a> это Apple IDE для разработки приложений для macOS и iOS. Он включает в себя широкий спектр инструментов командной строки, необходимых для общей сборки приложений, и, что полезно, они доступны в виде отдельного пакета без необходимости установки всего пакета Xcode.</p>
<p>Откройте окно <strong>Терминал</strong> на вашем Mac и введите следующую команду:</p>
<pre><code class="language-bash">sudo xcode-select --install;
</code></pre>
<p>Вам будет предложено ввести пароль в командной строке, а затем откроется окно установки, которое позволит вам загрузить и установить инструменты.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Вам следует запускать эту команду снова всякий раз, когда вы устанавливаете обновление macOS, потому что <em>иногда</em> ваш Mac не сохраняет инструменты командной строки в процессе обновления.</p>
</div>
<h3 id="homebrew_1">Установка Homebrew<a class="headerlink" href="#homebrew_1" title="Permanent link"></a></h3>
<p>В окне терминала введите следующую команду:</p>
<pre><code class="language-bash">/bin/bash -c &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install.sh)&quot;;
</code></pre>
<p>Просмотрите вывод и подтвердите при необходимости.</p>
<h2 id="homebrew_2">Установка пакетов Homebrew<a class="headerlink" href="#homebrew_2" title="Permanent link"></a></h2>
<p>Теперь пора использовать Homebrew для установки некоторых пакетов. Мы собираемся дать Homebrew некоторую информацию о некоторых дополнительных источниках пакетов, а затем установить (почти) все, что нам нужно, с помощью одной длинной команды.</p>
<h3 id="php-apache-mariadb-elasticsearch-mailhog-imagemagick">PHP, Apache, MariaDB, ElasticSearch, Mailhog, ImageMagick<a class="headerlink" href="#php-apache-mariadb-elasticsearch-mailhog-imagemagick" title="Permanent link"></a></h3>
<p>Следующая команда установит три версии <a href="https://www.php.net">PHP</a>, <a href="http://httpd.apache.org">Apache HTTP Server</a>, <a href="https://mariadb.com">MariaDB</a> (который мы будем использовать в качестве нашего механизма <a href="https://www.mysql.com">MySQL</a>), <a href="https://www.elastic.co">ElasticSearch</a>, <a href="https://github.com/mailhog/MailHog">MailHog</a> и <a href="https://imagemagick.org">ImageMagick</a>.</p>
<p>Если вы предпочитаете установить <a href="https://www.mysql.com">MySQL</a>, а не <a href="https://mariadb.com">MariaDB</a>, <a href="#note-for-cjk-users">прочтите это примечание</a>.</p>
<pre><code class="language-bash">brew tap elastic/tap;
brew tap shivammathur/php;
brew install pkg-config mariadb httpd mailhog imagemagick elastic/tap/elasticsearch-full shivammathur/php/php@5.6 shivammathur/php/php@7.4 shivammathur/php/php@8.0;
</code></pre>
<p>Выполнение этой команды займет несколько минут, так как здесь нужно установить много программного обеспечения, но все хорошее достается тем, кто ждет...</p>
<h3 id="php-xdebug-imagemagick">Несколько версий PHP с Xdebug и ImageMagick<a class="headerlink" href="#php-xdebug-imagemagick" title="Permanent link"></a></h3>
<p>Как я сказал ранее, этот процесс предоставит возможность запускать несколько версий PHP одновременно, без необходимости запускать скрипт для переключения между ними.</p>
<p>Выполните следующие команды, чтобы развернуть <a href="https://xdebug.org">Xdebug</a> и ImageMagick в каждой установленной вами версии PHP.</p>
<pre><code class="language-bash">brew unlink php;

brew link --force php@5.6;
pecl install xdebug-2.5.5;
printf &quot;\n&quot; | pecl install imagick;
brew unlink php@5.6;

brew link --force php@7.4;
pecl install xdebug;
printf &quot;\n&quot; | pecl install imagick;
brew unlink php@7.4;

brew link --force php@8.0;
pecl install xdebug;
printf &quot;\n&quot; | pecl install imagick;
</code></pre>
<p>Опять же, загрузка и установка всего необходимого программного обеспечения займет несколько минут.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>На момент написания ImageMagick не работает должным образом с PHP 8, но я оставил команду на месте, так как это могло измениться к тому времени, когда вы запускаете команды. Если команда <code>pecl install imagick</code> не работает для PHP 8, вы можете <a href="#build-imagick-manually">вручную создать расширение imagick</a>.</p>
</div>
<p><img alt="Снимок экрана: macOS с XenForo, отлаживаемая Xdebug с Visual Studio Code" src="../files/images/macos-debugging.jpg" /></p>
<h2 id="_1">Настройка<a class="headerlink" href="#_1" title="Permanent link"></a></h2>
<p>Насколько это возможно, мы постараемся минимизировать количество изменений, которые мы вносим в файлы конфигурации по умолчанию для каждого программного компонента, и вместо этого попросим сервер просмотреть дополнительные файлы конфигурации с нашими собственными конкретными инструкциями в них.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Конфигурации, которые я показываю здесь, содержат мое собственное имя пользователя macOS, <code>kier</code>, но в каждом случае вам нужно будет заменить <code>kier</code> своим собственным именем пользователя. Если вы не уверены, какое у вас имя пользователя Mac, используйте команду <code>whoami</code> в окне Терминала.</p>
</div>
<h3 id="mariadb">MariaDB<a class="headerlink" href="#mariadb" title="Permanent link"></a></h3>
<p>Теперь нам нужно запустить MariaDB.</p>
<p>В окне терминала введите следующие команды:</p>
<pre><code class="language-bash">brew services start mariadb;
sudo /usr/local/bin/mysql_upgrade;
</code></pre>
<p>Вам будет предложено ввести root-пароль MySQL - его еще нет, поэтому просто нажмите Enter, когда будет предложено.</p>
<p>Следующий:</p>
<pre><code class="language-bash">sudo /usr/local/bin/mysql_secure_installation;
</code></pre>
<p>Вы можете нажать Enter, чтобы принять значения по умолчанию для большинства вопросов, которые будет задавать этот скрипт, за исключением пароля root, который вам нужно будет установить. Поскольку это только установка для разработки, можно использовать пароль <code>root</code>.</p>
<h3 id="apache">Apache<a class="headerlink" href="#apache" title="Permanent link"></a></h3>
<p>Начните с редактирования следующего файла: <code>/usr/local/etc/httpd/httpd.conf</code></p>
<p>Оставьте все содержимое файла конфигурации без изменений, но в самом конце файла добавьте следующую строку:</p>
<pre><code class="language-apacheconf">Include /usr/local/etc/httpd/extra/httpd-dev.conf
</code></pre>
<p>Теперь создайте и отредактируйте файл <code>/usr/local/etc/httpd/extra/httpd-dev.conf</code></p>
<p>И в него добавьте следующее содержимое:</p>
<pre><code class="language-apacheconf">User kier
Group staff

Listen 80
ServerName localhost
Timeout 3600

LoadModule vhost_alias_module lib/httpd/modules/mod_vhost_alias.so
LoadModule rewrite_module lib/httpd/modules/mod_rewrite.so
LoadModule deflate_module lib/httpd/modules/mod_deflate.so
LoadModule mime_magic_module lib/httpd/modules/mod_mime_magic.so
LoadModule expires_module lib/httpd/modules/mod_expires.so
LoadModule proxy_module lib/httpd/modules/mod_proxy.so
LoadModule proxy_http_module lib/httpd/modules/mod_proxy_http.so
LoadModule proxy_fcgi_module lib/httpd/modules/mod_proxy_fcgi.so

&lt;IfModule dir_module&gt;
    DirectoryIndex index.html index.php
&lt;/IfModule&gt;

&lt;VirtualHost *:80&gt;
    DocumentRoot &quot;/Users/kier/Documents/www&quot;

    &lt;Directory &quot;/Users/kier/Documents/www&quot;&gt;
        Options Indexes FollowSymLinks
        AllowOverride all
        Require all granted
    &lt;/Directory&gt;

    &lt;FilesMatch \.php$&gt;
        SetHandler &quot;proxy:fcgi://localhost:9080&quot;
    &lt;/FilesMatch&gt;
&lt;/VirtualHost&gt;
</code></pre>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Предполагая, что вы измените три экземпляра <code>kier</code> на свое собственное имя пользователя, эта конфигурация будет ожидать обслуживания ваших веб-файлов из каталога <code>www</code> в вашей папке <code>Documents</code>. Вам нужно будет создать этот каталог или изменить оба экземпляра пути в конфигурации, если вы хотите обслуживать из другого каталога.</p>
</div>
<h3 id="php">PHP<a class="headerlink" href="#php" title="Permanent link"></a></h3>
<p>Каждая версия PHP требует собственных изменений конфигурации, но, к счастью, они незначительны.</p>
<h4 id="xdebug-mailhog">Xdebug и Mailhog<a class="headerlink" href="#xdebug-mailhog" title="Permanent link"></a></h4>
<p>Нам нужно установить некоторые разумные значения по умолчанию и включить Xdebug для каждой версии PHP.</p>
<p>Начните с редактирования файлов <code>php.ini</code> files at <code>/usr/local/etc/php/5.6/php.ini</code>, <code>/usr/local/etc/php/7.4/php.ini</code> и <code>/usr/local/etc/php/8.0/php.ini</code> и удалите все строки в верхней части файла, ссылающиеся на xdebug или imagick, затем сохраните файлы.</p>
<p>Затем создайте, отредактируйте и сохраните следующие три файла <em>ini</em> с указанным содержимым для каждого:</p>
<h5 id="usrlocaletcphp56confdphp-devini"><code>/usr/local/etc/php/5.6/conf.d/php-dev.ini</code><a class="headerlink" href="#usrlocaletcphp56confdphp-devini" title="Permanent link"></a></h5>
<pre><code class="language-ini">post_max_size = 20M
upload_max_filesize = 10M
date.timezone = UTC

[mailhog]
smtp_port = 1025
sendmail_path = &quot;/usr/local/bin/mhsendmail&quot;

[xdebug]
zend_extension = &quot;xdebug.so&quot;
xdebug.remote_enable = 1
xdebug.remote_connect_back = 1
xdebug.remote_port = 9000

[imagick]
extension = &quot;imagick.so&quot;
</code></pre>
<hr />
<h5 id="usrlocaletcphp74confdphp-devini-usrlocaletcphp80confdphp-devini"><code>/usr/local/etc/php/7.4/conf.d/php-dev.ini</code> <strong>и</strong> <code>/usr/local/etc/php/8.0/conf.d/php-dev.ini</code><a class="headerlink" href="#usrlocaletcphp74confdphp-devini-usrlocaletcphp80confdphp-devini" title="Permanent link"></a></h5>
<pre><code class="language-ini">post_max_size = 20M
upload_max_filesize = 10M
date.timezone = UTC

[mailhog]
smtp_port = 1025
sendmail_path = &quot;/usr/local/bin/mhsendmail&quot;

[xdebug]
zend_extension = &quot;xdebug.so&quot;
xdebug.mode = &quot;debug,develop&quot;
xdebug.discover_client_host = 1
xdebug.client_port = 9000

[imagick]
extension = &quot;imagick.so&quot;
</code></pre>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>На момент написания <code>pecl install imagick</code> некорректно работал с PHP 8. Если вы получаете ошибки при попытке запустить эту команду, и вы не хотите <a href="#build-imagick-manually">создавать расширение imagick вручную</a>, тогда вам нужно будет закомментировать строку <code>extension = "imagick.so"</code> из PHP 8 php-dev.ini, добавив начальную точку с запятой.</p>
</div>
<hr />
<h4 id="fast-cgi-php-fpm">Fast CGI (php-fpm)<a class="headerlink" href="#fast-cgi-php-fpm" title="Permanent link"></a></h4>
<p>Мы собираемся использовать реализацию PHP FastCGI Process Manager (FPM), чтобы разрешить переключение версий, но сначала нам нужно сообщить каждой версии PHP, как реагировать, чтобы мы могли запускать несколько версий одновременно.</p>
<p>Создайте следующий файл, затем введите и сохраните содержимое, указанное ниже, изменив имя пользователя на свое:</p>
<p><code>/usr/local/etc/php/5.6/php-fpm.d/x.conf</code></p>
<pre><code class="language-apacheconf">user = kier
group = staff
listen = 127.0.0.1:9056
</code></pre>
<p>Обратите внимание на использование порта <code>9056</code>. Я получил <code>9056</code>, удалив десятичную точку из номера версии PHP <code>5.6</code> и добавив конкатенированное значение <code>56</code> к <code>9000</code>, в результате чего получилось <code>9056</code>.</p>
<p>Затем вам нужно будет скопировать этот файл в следующие места, при необходимости изменив номер порта:</p>
<p><code>/usr/local/php/7.4/php-fpm.d/x.conf</code> (используя порт <code>9074</code>)</p>
<p><code>/usr/local/php/8.0/php-fpm.d/x.conf</code> (используя порт <code>9080</code>)</p>
<p>В то время как PHP 7.4 и 8.0 будут лишать нашу недавно заданную конфигурацию FPM, PHP 5.6 требуется небольшая помощь. Отредактируйте файл <code>/usr/local/etc/php/5.6/php-fpm.conf</code> и в самом низу файла добавьте следующее:</p>
<pre><code class="language-apacheconf">include=/usr/local/etc/php/5.6/php-fpm.d/*.conf
</code></pre>
<h4 id="-">Авто-старт<a class="headerlink" href="#-" title="Permanent link"></a></h4>
<p>Теперь, когда все настроено, мы можем запустить серверы и дать им указание загружаться при запуске системы.</p>
<pre><code class="language-bash">brew services start elasticsearch-full;
brew services start php@5.6;
brew services start php@7.4;
brew services start php@8.0;
brew services start httpd;
</code></pre>
<h2 id="php_1">Выбор версии PHP<a class="headerlink" href="#php_1" title="Permanent link"></a></h2>
<p>Это умная часть. Мы можем проинструктировать Apache передавать скрипты PHP в любую из установленных нами версий PHP с небольшой конфигурацией в файле <code>.htaccess</code>.</p>
<p>В конфигурации, которую мы создали <a href="#apache">выше</a>, сервер по умолчанию будет использовать PHP 8.0, но это легко переопределить для каждого каталога отдельно.</p>
<p>В папке <code>Documents/www</code> создайте следующее дерево папок и файлов (или загрузите <a href="../files/info.zip">этот zip файл</a>, содержащий то же содержимое):</p>
<ul>
<li>Documents<ul>
<li>www<ul>
<li>info<ul>
<li>php5.6<ul>
<li>info.php</li>
</ul>
</li>
<li>php7.4<ul>
<li>info.php</li>
</ul>
</li>
<li>php8.0<ul>
<li>info.php</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>В каждый из этих файлов <code>index.php</code>, добавьте следующее содержимое:</p>
<pre><code class="language-php">&lt;?php

phpinfo();
</code></pre>
<p>Если вы посетите любое из этих мест с помощью своего браузера, вы увидите <strong>PHP 8.0</strong>, указанную как используемую версию.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Поскольку мы поместили каталог <code>www</code> в вашу папку <code>Documents</code>, что дает некоторые преимущества, такие как потенциально автоматическое резервное копирование вашей папки <code>www</code> в iCloud, это также вызовет несколько раздражающие запросы разрешения, когда Apache и каждая версия PHP сначала попытаются получить доступ к каталогу <code>www</code>. Просто следите за подсказками и подтверждайте их, когда они появляются.</p>
</div>
<p>Затем создайте файл <code>.htaccess</code> в каталоге каждой версии php вместе с файлом <code>info.php</code> и добавьте следующее содержимое:</p>
<h3 id="htaccess-php-56">.htaccess для PHP 5.6<a class="headerlink" href="#htaccess-php-56" title="Permanent link"></a></h3>
<pre><code class="language-apacheconf">&lt;FilesMatch \.php$&gt;
    SetHandler &quot;proxy:fcgi://localhost:9056&quot;
&lt;/FilesMatch&gt;
</code></pre>
<h3 id="htaccess-php-74">.htaccess для PHP 7.4<a class="headerlink" href="#htaccess-php-74" title="Permanent link"></a></h3>
<pre><code class="language-apacheconf">&lt;FilesMatch \.php$&gt;
    SetHandler &quot;proxy:fcgi://localhost:9074&quot;
&lt;/FilesMatch&gt;
</code></pre>
<h3 id="htaccess-php-80">.htaccess для PHP 8.0<a class="headerlink" href="#htaccess-php-80" title="Permanent link"></a></h3>
<pre><code class="language-apacheconf">&lt;FilesMatch \.php$&gt;
    SetHandler &quot;proxy:fcgi://localhost:9080&quot;
&lt;/FilesMatch&gt;
</code></pre>
<p>Обратите внимание на использование наших номеров портов из нашей <a href="#fast-cgi-php-fpm">конфигурации FPM</a> здесь.</p>
<p>С этими файлами обновление информационных страниц PHP для любого из этих каталогов версии PHP должно показывать правильную версию PHP. Любые файлы PHP, обслуживаемые из этих каталогов, также должны использовать ту же версию PHP.</p>
<p>Теперь вы можете свободно разбросать эти файлы .htaccess по вашему каталогу <code>www</code>, чтобы любой каталог выбирал любую версию PHP по вашему выбору.</p>
<p><img alt="Снимок экрана: Три версии PHP, работающие одновременно через веб-сервер Apache" src="../files/images/macos-php-versions.png" /></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Файлы <code>.htaccess</code> в <a href="../files/info.zip">загружаемом zip</a> закомментированы директивой <code>SetHandler</code>, вам нужно будет удалить начальный символ <code>#</code> из этой строки, прежде чем директива будет работать.</p>
</div>
<h2 id="ide">IDE, отладка и менеджер БД<a class="headerlink" href="#ide" title="Permanent link"></a></h2>
<p>Чтобы получить максимальную отдачу от этого мощного программного пакета для веб-серверов, который вы сейчас собрали, важно выйти за рамки простого текстового редактора для ваших нужд кодирования.</p>
<p>Ознакомьтесь с нашим разделом <a href="../vscode/">Visual Studio Code и его использование с Xdebug</a>.</p>
<h2 id="_2">Ссылки на ресурсы<a class="headerlink" href="#_2" title="Permanent link"></a></h2>
<ul>
<li><a href="https://code.visualstudio.com/">Visual Studio Code</a></li>
<li><a href="https://tableplus.io/">TablePlus</a></li>
<li><a href="https://brew.sh">Homebrew</a></li>
<li><a href="https://xdebug.org">Xdebug</a></li>
<li><a href="https://apps.apple.com/gb/app/xdebugtoggle/id1437227804?mt=12">XdebugToggle для Safari</a></li>
<li><a href="https://youtu.be/kiFqrd_dHz8">Видео этого процесса</a></li>
</ul>
<hr />
<h2 id="_3">Обобщение<a class="headerlink" href="#_3" title="Permanent link"></a></h2>
<h3 id="_4">Сводка команд терминала<a class="headerlink" href="#_4" title="Permanent link"></a></h3>
<pre><code class="language-bash">#!/bin/bash

# установить инструменты разработки командной строки macOS
sudo xcode-select --install;

# установить homebrew
/bin/bash -c &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install.sh)&quot;;

# дополнительные источники пакетов homebrew
brew tap elastic/tap;
brew tap shivammathur/php;

# установить пакеты homebrew
brew install pkg-config mariadb httpd mailhog imagemagick elastic/tap/elasticsearch-full;

# установить php 5.6
brew install shivammathur/php/php@5.6;
pecl install xdebug-2.5.5;
printf &quot;\n&quot; | pecl install imagick;

# установить php 7.4
brew install shivammathur/php/php@7.4;
pecl install xdebug;
printf &quot;\n&quot; | pecl install imagick;

# установить php 8.0
brew install shivammathur/php/php@8.0;
pecl install xdebug;
# эта команда не работает с PHP 8.0 на момент написания
printf &quot;\n&quot; | pecl install imagick;

# запустить и настроить mariadb
brew services start mariadb;
sudo /usr/local/bin/mysql_upgrade;
sudo /usr/local/bin/mysql_secure_installation;

#
# На этом этапе отредактируйте файлы конфигурации для Apache и PHP,
# смотрите «Сводку конфигурации» ниже.
#

# запустить остальные сервисы
brew services start elasticsearch-full;
brew services start php@5.6;
brew services start php@7.4;
brew services start php@8.0;
brew services start httpd;
</code></pre>
<h3 id="_5">Сводка конфигурации<a class="headerlink" href="#_5" title="Permanent link"></a></h3>
<h4 id="_6">Сделайте следующие правки<a class="headerlink" href="#_6" title="Permanent link"></a></h4>
<p>Отредактируйте следующие файлы, как описано:</p>
<p>В конце <code>/usr/local/etc/httpd/httpd.conf</code>, добавьте</p>
<pre><code class="language-apacheconf">Include /usr/local/etc/httpd/extra/httpd-dev.conf
</code></pre>
<p>В <code>/usr/local/etc/php/</code> отредактируйте файлы <code>5.6/php.ini</code>, <code>7.4/php.ini</code> и <code>8.0/php,ini</code>, найдите строки расширений <em>imagick.so</em> и <em>xdebug.so</em> в верхней части файла, и если они существуют, закомментируйте их следующим образом:</p>
<pre><code class="language-ini">; extension=&quot;imagick.so&quot;
; zend_extension=&quot;xdebug.so&quot;
</code></pre>
<p>В конце <code>/usr/local/etc/php/5.6/php-fpm.conf</code>, добавьте</p>
<pre><code class="language-apacheconf">include=/usr/local/etc/php/5.6/php-fpm.d/*.conf
</code></pre>
<h4 id="_7">Добавьте следующие файлы<a class="headerlink" href="#_7" title="Permanent link"></a></h4>
<p>Загрузите связанные файлы и поместите их в указанные каталоги, создав содержащий каталог, если он еще не существует, и заменив экземпляры моего имени пользователя <code>kier</code> своим собственным именем пользователя macOS. Найдите свое собственное имя пользователя, запустив <code>whoami</code> в терминале:</p>
<ol>
<li><code>/usr/local/etc/httpd/extra/</code><a href="../files/macos/httpd/httpd-dev.conf"><code>httpd-dev.conf</code></a></li>
<li><code>/usr/local/etc/php/5.6/conf.d/</code><a href="../files/macos/php56/php-dev.ini"><code>php-dev.ini</code></a></li>
<li><code>/usr/local/etc/php/5.6/php-fpm.d/</code><a href="../files/macos/php56/x.conf"><code>x.conf</code></a></li>
<li><code>/usr/local/etc/php/7.4/conf.d/</code><a href="../files/macos/php74/php-dev.ini"><code>php-dev.ini</code></a></li>
<li><code>/usr/local/etc/php/7.4/php-fpm.d/</code><a href="../files/macos/php74/x.conf"><code>x.conf</code></a></li>
<li><code>/usr/local/etc/php/8.0/conf.d/</code><a href="../files/macos/php80/php-dev.ini"><code>php-dev.ini</code></a></li>
<li><code>/usr/local/etc/php/8.0/php-fpm.d/</code><a href="../files/macos/php80/x.conf"><code>x.conf</code></a></li>
</ol>
<h3 id="htaccess-php">Файлы .htaccess, ориентированные на версии PHP<a class="headerlink" href="#htaccess-php" title="Permanent link"></a></h3>
<p>Следующие файлы можно поместить в каталог на вашем веб-сервере, чтобы все файлы PHP в этой папке использовали определенную версию PHP.</p>
<p>Переименуйте файлы из <code>htaccess.txt</code> в <code>.htaccess</code> после помещения их в папку назначения.</p>
<ol>
<li>PHP 5.6 <a href="../files/macos/php56/htaccess.txt"><code>.htaccess</code></a></li>
<li>PHP 7.4 <a href="../files/macos/php74/htaccess.txt"><code>.htaccess</code></a></li>
<li>PHP 8.0 <a href="../files/macos/php80/htaccess.txt"><code>.htaccess</code></a></li>
</ol>
<h2 id="cjk">Примечание для пользователей CJK<a class="headerlink" href="#cjk" title="Permanent link"></a></h2>
<p>Было указано, что <a href="https://xenforo.com/community/threads/developer-ide-and-server-software-setup-guides.191195/post-1499966">MariaDB не особенно хорошо работает с языками CJK</a>. Если поддержка CJK важна для вашего процесса разработки, вам следует заменить команды, ссылающиеся с <code>mariadb</code> на <code>mysql</code>, что приведет к установке MySQL 8.0 вместо этого.</p>
<p>В частности, команды, которые следует изменить:</p>
<pre><code class="language-bash"># установить пакеты, включая MariaDB:
brew install pkg-config mariadb httpd mailhog imagemagick elastic/tap/elasticsearch-full shivammathur/php/php@5.6 shivammathur/php/php@7.4 shivammathur/php/php@8.0;

# вместо этого установите пакеты, используя MySQL:
brew install pkg-config mysql httpd mailhog imagemagick elastic/tap/elasticsearch-full shivammathur/php/php@5.6 shivammathur/php/php@7.4 shivammathur/php/php@8.0;

# запустить сервис MariaDB
brew services start mariadb

# вместо этого запустите сервис MySQL
brew services start mysql
</code></pre>
<p><img alt="Снимок экрана: Панель управления администратора XenForo сообщает об установке MySQL вместо MariaDB" src="../files/images/server-report.png" /></p>
<h2 id="imagick">Создавайте Imagick вручную<a class="headerlink" href="#imagick" title="Permanent link"></a></h2>
<p>В случае, если стандартная команда <code>pecl install imagick</code> не работает для PHP 8, что она и делает на момент написания, можно установить расширение <code>imagick.so</code>, собрав его вручную, что не так сложно. может звучать.</p>
<p>Найдите на вашей рабочей станции место для работы - я обычно создаю для этой цели каталог с именем <code>/usr/local/build</code> и <code>cd</code> в этот каталог. Оказавшись там, выполните следующие команды::</p>
<pre><code class="language-bash">brew link --force --overwrite php@8.0
git clone https://github.com/Imagick/imagick
cd imagick
phpize &amp;&amp; ./configure
make
make install
</code></pre>
<p>Предполагая, что проблем не возникло, это должно было поместить недавно созданный <code>imagick.so</code> в правильный каталог модулей, а именно <code>/usr/local/lib/php/pecl/20200930/imagick.so</code>, где <code>20200930</code> представляет собой номер сборки вашей версии PHP 8.</p>
<p>На этом этапе директива <code>extension = "imagick.so"</code> в вашем файле <code>/usr/local/etc/php/8.0/conf.d/php-dev.ini</code> автоматически найдет правильное расширение при запуске PHP. 8.</p>

            </div>
          </div>
          

<div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
	
	<a href="linux-dev/" class="btn btn-neutral float-right" title="Среда разработки Linux">Следующая <span class="icon icon-circle-arrow-right"></span></a>
	
	
	<a href="template-syntax/" class="btn btn-neutral" title="Синтаксис шаблонов"><span class="icon icon-circle-arrow-left"></span> Предыдущая</a>
	
</div>


<footer>
	<div role="contentinfo">
		<!-- Copyright etc -->
		
		<p><a href="https://xenforo.com/" target="_blank">Документация разработчика для XenForo&reg; 2.x &copy;2010-2021 XenForo Ltd.</a><br><a href="https://xenforo.su/" target="_blank">Перевод документации разработчика для XenForo&reg; 2.x &copy;2010-2021 XenForo.su</a></p>
		
		<p>
			Создан с помощью <a href="http://www.mkdocs.org">MkDocs</a> с использованием <a href="https://github.com/snide/sphinx_rtd_theme">темы</a>, предоставленной <a href="https://readthedocs.org">Read the Docs</a> и измененной <a href="https://xenforo.com">XenForo Ltd.</a>
		</p>
	</div>
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/xenforo-ru/docs/" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../template-syntax/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../linux-dev/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
